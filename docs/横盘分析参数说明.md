# 横盘分析参数说明文档

## 概述

横盘分析功能用于判断股票是否处于横盘整理阶段。横盘是指股价在一定范围内波动，没有明显的上涨或下跌趋势。

## 核心参数说明

### 1. 周期数（Period）

**含义**：分析最近多少个 K 线周期

**默认值**：10

**说明**：

- 如果选择日 K 线，周期数 10 表示分析最近 10 天
- 如果选择周 K 线，周期数 10 表示分析最近 10 周
- 周期数越大，分析的时间范围越长，但可能不够敏感
- 周期数越小，分析的时间范围越短，但可能过于敏感

**建议值**：

- 日 K 线：10-20
- 周 K 线：5-10

---

### 2. 价格波动阈值（Price Volatility Threshold）

**含义**：判断价格波动是否足够小的阈值（百分比）

**默认值**：5%

**计算公式**：

```
波动率 = (最近N天最高价 - 最近N天最低价) / 最近N天平均收盘价 × 100%

判断：如果 波动率 < 价格波动阈值，则认为是横盘
```

**示例**：

- 最近 10 天：最高价 11 元，最低价 9 元，平均收盘价 10 元
- 波动率 = (11 - 9) / 10 × 100% = 20%
- 如果阈值设为 5%，则 20% > 5%，**不是横盘**
- 如果阈值设为 25%，则 20% < 25%，**是横盘**

**建议值**：

- **严格模式**：3-5%（只筛选波动很小的股票）
- **中等模式**：5-8%（平衡筛选）
- **宽松模式**：8-15%（筛选更多股票）

---

### 3. MA 离散度阈值（MA Spread Threshold）

**含义**：判断多条均线是否足够接近的阈值（百分比）

**默认值**：3%

**计算公式**：

```
1. 计算MA5、MA10、MA20（5日、10日、20日均线）
2. 计算三条均线的平均值：平均MA = (MA5 + MA10 + MA20) / 3
3. 计算每条均线与平均值的最大偏差
4. MA离散度 = 最大偏差 / 平均MA × 100%

判断：如果 MA离散度 < MA离散度阈值，则认为是横盘
```

**示例**：

- MA5 = 10.2 元，MA10 = 10.0 元，MA20 = 9.8 元
- 平均 MA = (10.2 + 10.0 + 9.8) / 3 = 10.0 元
- 最大偏差 = max(|10.2-10.0|, |10.0-10.0|, |9.8-10.0|) = 0.2 元
- MA 离散度 = 0.2 / 10.0 × 100% = 2%
- 如果阈值设为 3%，则 2% < 3%，**是横盘**（均线收敛）

**建议值**：

- **严格模式**：2-3%（均线非常接近）
- **中等模式**：3-5%（均线较为接近）
- **宽松模式**：5-8%（均线相对接近）

---

### 4. 缩量阈值（Volume Shrinking Threshold）

**含义**：判断成交量是否萎缩的阈值（百分比）

**默认值**：80%

**计算公式**：

```
1. 近期平均成交量 = 最近N天的平均成交量
2. 长期平均成交量 = 往前推N天到2N天的平均成交量
3. 成交量比率 = 近期平均成交量 / 长期平均成交量 × 100%

判断：如果 成交量比率 < 缩量阈值，则认为是缩量
```

**示例**：

- 最近 10 天平均成交量：1000 万股
- 往前 10-20 天平均成交量：1500 万股
- 成交量比率 = 1000 / 1500 × 100% = 66.7%
- 如果阈值设为 80%，则 66.7% < 80%，**是缩量**

**说明**：

- 横盘时通常伴随成交量萎缩
- 如果勾选"必须缩量"，则只有缩量的股票才会被判定为横盘
- 如果不勾选，缩量只是参考指标，不影响横盘判断

**建议值**：

- **严格模式**：70-80%（成交量明显萎缩）
- **中等模式**：80-90%（成交量适度萎缩）
- **宽松模式**：90-100%（成交量基本持平）

---

### 5. 横盘强度范围（Consolidation Strength Range）

**含义**：横盘强度的筛选范围（0-100）

**默认值**：不限制（显示所有横盘股票）

**强度计算公式**：

```
价格波动率法强度 = 100 - (波动率 / 价格波动阈值) × 100
MA收敛法强度 = 100 - (MA离散度 / MA离散度阈值) × 100
综合强度 = (价格波动率法强度 + MA收敛法强度) / 2
```

**强度含义**：

- **0-30**：弱横盘（波动较大或均线离散）
- **30-60**：中等横盘
- **60-80**：强横盘（波动较小且均线收敛）
- **80-100**：极强横盘（几乎不动）

**使用场景**：

- 设置最小值：只显示强度 ≥X 的股票（如：只显示强度 ≥60 的强横盘股票）
- 设置最大值：只显示强度 ≤X 的股票（较少使用）
- 设置范围：只显示强度在 X-Y 之间的股票

**建议值**：

- **只看强横盘**：最小值=60，最大值=100
- **只看极强横盘**：最小值=80，最大值=100
- **所有横盘**：不设置范围

---

## 判断方法说明

### 价格波动率法

**原理**：通过计算价格波动幅度来判断是否横盘

**优点**：

- 简单直观，容易理解
- 计算快速
- 适合快速筛选

**缺点**：

- 可能忽略短期波动
- 对趋势不敏感

**适用场景**：快速筛选，初步判断

---

### MA 收敛法

**原理**：通过判断多条均线是否收敛来判断是否横盘

**优点**：

- 符合技术分析习惯
- 能识别趋势转换
- 更符合交易逻辑

**缺点**：

- 需要足够的数据
- MA 计算有滞后性

**适用场景**：识别横盘整理，判断趋势转换

---

### 筛选模式

**都满足（AND）**：

- 两种方法都满足才算横盘
- 更严格，筛选出的股票更少但更准确
- 适合追求高准确率的场景

**任一满足（OR）**：

- 任一方法满足就算横盘
- 更宽松，筛选出的股票更多
- 适合不想错过任何横盘股票的场景

---

## 参数组合建议

### 严格模式（高准确率）

- 周期数：10
- 价格波动阈值：3%
- MA 离散度阈值：2%
- 缩量阈值：75%
- 必须缩量：是
- 横盘强度范围：最小值=70

### 中等模式（平衡）

- 周期数：10
- 价格波动阈值：5%
- MA 离散度阈值：3%
- 缩量阈值：80%
- 必须缩量：否
- 横盘强度范围：不限制

### 宽松模式（不遗漏）

- 周期数：10
- 价格波动阈值：8%
- MA 离散度阈值：5%
- 缩量阈值：90%
- 必须缩量：否
- 横盘强度范围：不限制

---

## 常见问题

### Q1: 为什么我的股票没有被判定为横盘？

**可能原因**：

1. 价格波动太大（超过价格波动阈值）
2. 均线离散度太大（超过 MA 离散度阈值）
3. 成交量没有萎缩（如果勾选了"必须缩量"）
4. 横盘强度不在设置的范围内

**解决方法**：

- 适当放宽阈值
- 取消"必须缩量"选项
- 扩大横盘强度范围

---

### Q2: 如何选择合适的周期数？

**建议**：

- 如果想看短期横盘（1-2 周），周期数设为 5-10
- 如果想看中期横盘（1-2 月），周期数设为 10-20
- 如果想看长期横盘（3-6 月），周期数设为 20-30

**注意**：周期数不能超过获取的 K 线数据总数

---

### Q3: 价格波动阈值和 MA 离散度阈值有什么区别？

**区别**：

- **价格波动阈值**：看的是价格本身的波动（最高价-最低价）
- **MA 离散度阈值**：看的是均线的收敛程度（均线之间的距离）

**关系**：

- 价格波动小，不一定均线收敛（可能价格在均线附近波动）
- 均线收敛，不一定价格波动小（可能价格在均线之间来回波动）
- 两种方法结合使用，判断更准确

---

### Q4: 横盘强度有什么用？

**用途**：

- 筛选出横盘程度更强的股票
- 强度越高，说明横盘越明显，可能越接近突破点
- 可以根据强度排序，优先关注强度高的股票

---

## 更新记录

- 2024-XX-XX：初始版本，包含所有参数说明
